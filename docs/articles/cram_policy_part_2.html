<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cram Policy part 2 • cramR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cram Policy part 2">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Load Inter font --><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;display=swap" rel="stylesheet">
<style>
  :root {
    --primary-gradient: linear-gradient(135deg, #2c3e50, #3498db);
    --hover-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }

  .navbar {
    background-color: rgba(255, 255, 255, 0.95); /* Light background with slight transparency */
    box-shadow: 0 2px 10px rgba(0,0,0,0.1); /* Optional shadow for depth */
  }

  body {
    padding-top: 80px;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Inter', sans-serif;
  }

  code, pre, kbd {
    font-family: 'JetBrains Mono', monospace;
    background-color: #f5f5f5;
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 90%;
  }

  pre {
    overflow-x: auto;
  }

  pre code {
    padding: 1em;
    display: block;
  }

  .navbar-brand img {
    height: 40px;
    transition: transform 0.3s ease;
  }

  .navbar-brand:hover img {
    transform: scale(1.05);
  }

  .hero-banner {
    background: var(--primary-gradient);
    padding: 6rem 1rem;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }

  .feature-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin: 1rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }

  .feature-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--hover-shadow);
  }

  /* Add hover effect to make the navbar more readable */
  .navbar:hover {
    background-color: rgba(255, 255, 255, 1); /* Fully visible on hover */
  }

  /* Add space below the navbar to prevent cutting off content */
  main {
    padding-top: 1rem;
  }
</style>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cramR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cram_policy_part_1.html">Introduction &amp; Cram Policy part 1</a></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/cram_policy_part_2.html">Cram Policy part 2</a></li>
    <li><a class="dropdown-item" href="../articles/cram_ml.html">Cram ML</a></li>
    <li><a class="dropdown-item" href="../articles/cram_bandit.html">Cram Bandit</a></li>
    <li><a class="dropdown-item" href="../articles/cram_bandit_helpers.html">Cram Bandit Helpers</a></li>
    <li><a class="dropdown-item" href="../articles/cram_learning.html">Cram Policy Learning</a></li>
    <li><a class="dropdown-item" href="../articles/cram_ml_learning.html">Cram ML Learning</a></li>
    <li><a class="dropdown-item" href="../articles/cram_policy_simulation.html">Cram Policy Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/cram_bandit_simulation.html">Cram Bandit Simulation</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-resources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Resources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-resources">
<li><a class="dropdown-item" href="../reference/index.html">Function Reference</a></li>
    <li><a class="dropdown-item" href="../news/index.html">Release Notes</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yanisvdc/cramR" aria-label="GitHub repository"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.hbs.edu/ris/Publication%20Files/2403.07031v1_a83462e0-145b-4675-99d5-9754aa65d786.pdf" aria-label="Research paper"><span class="fa fa-solid fa-file-pdf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cram Policy part 2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yanisvdc/cramR/blob/HEAD/vignettes/cram_policy_part_2.Rmd" class="external-link"><code>vignettes/cram_policy_part_2.Rmd</code></a></small>
      <div class="d-none name"><code>cram_policy_part_2.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="cram-policy">Cram Policy<a class="anchor" aria-label="anchor" href="#cram-policy"></a>
</h2>
<p>In the article <em>“Introduction &amp; Cram Policy Part 1”</em>, we
introduced the Cram method, which enables simultaneous learning and
evaluation of a binary policy. We outlined the primary parameters of the
<code><a href="../reference/cram_policy.html">cram_policy()</a></code> function and demonstrated its application
using an example dataset. In this section, we provide a more detailed
discussion on how to configure these parameters for various use cases,
depending notably on the nature of the dataset and specific policy
learning goals.</p>
<p>We begin by simulating a dataset consisting of covariates
<code>X</code>, a binary treatment assignment <code>D</code>, and a
continuous outcome <code>Y</code>, which we will use to demonstrate the
<code><a href="../reference/cram_policy.html">cram_policy()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="co"># Function to generate sample data with heterogeneous treatment effects:</span></span>
<span><span class="co"># - Positive effect group</span></span>
<span><span class="co"># - Neutral effect group</span></span>
<span><span class="co"># - Adverse effect group</span></span>
<span><span class="va">generate_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>    binary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,                 <span class="co"># Binary variable</span></span>
<span>    discrete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,  <span class="co"># Discrete variable</span></span>
<span>    continuous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>                       <span class="co"># Continuous variable</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Binary treatment assignment (50% treated)</span></span>
<span>  <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Define heterogeneous treatment effects based on X</span></span>
<span>  <span class="va">treatment_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="va">X</span><span class="op">[</span>, <span class="va">binary</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">X</span><span class="op">[</span>, <span class="va">discrete</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">2</span>,        <span class="co"># Group 1: Positive effect</span></span>
<span>    <span class="fl">1</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="va">binary</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">X</span><span class="op">[</span>, <span class="va">discrete</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">4</span>, <span class="co"># Group 3: Adverse effect</span></span>
<span>           <span class="op">-</span><span class="fl">1</span>,</span>
<span>           <span class="fl">0.1</span><span class="op">)</span>                                   <span class="co"># Group 2: Neutral effect</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Outcome depends on treatment effect + noise</span></span>
<span>  <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">*</span> <span class="op">(</span><span class="va">treatment_effect</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">D</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, D <span class="op">=</span> <span class="va">D</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generate a sample dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">D</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y</span></span></code></pre></div>
<div class="section level3">
<h3 id="built-in-model">Built-in Model<a class="anchor" aria-label="anchor" href="#built-in-model"></a>
</h3>
<p>In this example, we demonstrate how to use the <strong>built-in
modeling options</strong> provided by the <code>cramR</code> package. We
walk through the key parameters that control how
<code><a href="../reference/cram_policy.html">cram_policy()</a></code> behaves, including the choice of model,
learner type, baseline policy, and batching strategy.</p>
<p>These parameters allow flexibility in configuring the learning
process depending on your use case and nature of your dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Options for batch:</span></span>
<span><span class="co"># Either an integer specifying the number of batches or a vector/list of batch assignments for all individuals</span></span>
<span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># Model type for estimating treatment effects</span></span>
<span><span class="co"># Options for model_type: 'causal_forest', 's_learner', 'm_learner'</span></span>
<span><span class="co"># Note: you can also set model_type to NULL and specify custom_fit and custom_predict to use your custom model</span></span>
<span><span class="va">model_type</span> <span class="op">&lt;-</span> <span class="st">"causal_forest"</span>  </span>
<span></span>
<span><span class="co"># Options for learner_type:</span></span>
<span><span class="co"># if model_type == 'causal_forest', choose NULL</span></span>
<span><span class="co"># if model_type == 's_learner' or 'm_learner', choose between 'ridge', 'fnn' and 'caret'</span></span>
<span><span class="va">learner_type</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>  </span>
<span></span>
<span><span class="co"># Baseline policy to compare against (list of 0/1 for each individual)</span></span>
<span><span class="co"># Options for baseline_policy:</span></span>
<span><span class="co"># A list representing the baseline policy assignment for each individual.</span></span>
<span><span class="co"># If NULL, a default baseline policy of zeros is created.</span></span>
<span><span class="co"># Examples of baseline policy: </span></span>
<span><span class="co"># - All-control baseline: as.list(rep(0, nrow(X))) or NULL</span></span>
<span><span class="co"># - Randomized baseline: as.list(sample(c(0, 1), nrow(X), replace = TRUE))</span></span>
<span><span class="va">baseline_policy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Whether to parallelize batch processing (i.e. the cram method learns T policies, with T the number of batches.</span></span>
<span><span class="co"># They are learned in parallel when parallelize_batch is TRUE</span></span>
<span><span class="co"># vs. learned sequentially using the efficient data.table structure when parallelize_batch is FALSE, recommended for light weight training).</span></span>
<span><span class="co"># Defaults to FALSE.</span></span>
<span><span class="va">parallelize_batch</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>  </span>
<span> </span>
<span></span>
<span><span class="co"># Model-specific parameters (more details in the article "Quick Start")</span></span>
<span><span class="co"># Examples: NULL defaults to the following:</span></span>
<span><span class="co"># - causal_forest: list(num.trees = 100)</span></span>
<span><span class="co"># - ridge: list(alpha = 1)</span></span>
<span><span class="co"># - caret: list(formula = Y ~ ., caret_params = list(method = "lm", trControl = trainControl(method = "none")))</span></span>
<span><span class="co"># - fnn (Feedforward Neural Network): see below</span></span>
<span><span class="co"># input_shape &lt;- if (model_type == "s_learner") ncol(X) + 1 else ncol(X)</span></span>
<span><span class="co"># default_model_params &lt;- list(</span></span>
<span><span class="co">#       input_layer = list(units = 64, activation = 'relu', input_shape = input_shape),</span></span>
<span><span class="co">#       layers = list(</span></span>
<span><span class="co">#         list(units = 32, activation = 'relu')</span></span>
<span><span class="co">#       ),</span></span>
<span><span class="co">#       output_layer = list(units = 1, activation = 'linear'),</span></span>
<span><span class="co">#       compile_args = list(optimizer = 'adam', loss = 'mse'),</span></span>
<span><span class="co">#       fit_params = list(epochs = 5, batch_size = 32, verbose = 0)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="va">model_params</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>  </span></code></pre></div>
<div class="section level4">
<h4 id="how-to-set-model_params">How to set model_params?<a class="anchor" aria-label="anchor" href="#how-to-set-model_params"></a>
</h4>
<p>The <code>model_params</code> argument allows you to customize
hyperparameters for the model used in policy learning. If left as
<code>NULL</code>, <code><a href="../reference/cram_policy.html">cram_policy()</a></code> will fall back to sensible
defaults depending on the model and learner type. In the following, we
give default examples of <code>model_params</code> for each
<code>model_type</code> and <code>learner_type</code> to illustrate how
you can specify <code>model_params</code>. Generally speaking,
<code>model_params</code> is a list containing all of the parameters
used in the underlying model and its values:</p>
<ul>
<li><p>For <code>model_type = "causal_forest"</code>:<br>
When <code>model_params &lt;- NULL</code>, the method defaults to
<code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">grf::causal_forest()</a></code> with
<code>model_params &lt;- list(num.trees = 100)</code>.</p></li>
<li>
<p>For <code>model_type = "s_learner"</code> or
<code>"m_learner"</code>, it depends on the
<code>learner_type</code>:</p>
<ul>
<li><p>For <code>learner_type = "ridge"</code>, when
<code>model_params &lt;- NULL</code>, the method defaults to
<code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">glmnet::cv.glmnet()</a></code> with
<code>model_params &lt;- list(alpha = 1)</code>, corresponding to Ridge
regression.</p></li>
<li><p>For <code>learner_type = "fnn"</code> (Feedforward Neural
Network):<br>
A default Keras model is built with the following architecture:</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine the input shape based on model_type</span></span>
<span><span class="co"># For s_learner, the treatment D is added to the covariates to constitute the training data</span></span>
<span><span class="co"># So the input shape is ncol(X) + 1</span></span>
<span><span class="va">input_shape</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model_type</span> <span class="op">==</span> <span class="st">"s_learner"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="va">default_model_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    input_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">64</span>, activation <span class="op">=</span> <span class="st">'relu'</span>, input_shape <span class="op">=</span> <span class="va">input_shape</span><span class="op">)</span>, </span>
<span>    layers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">32</span>, activation <span class="op">=</span> <span class="st">'relu'</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">1</span>, activation <span class="op">=</span> <span class="st">'linear'</span><span class="op">)</span>,</span>
<span>    compile_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">'adam'</span>, loss <span class="op">=</span> <span class="st">'mse'</span><span class="op">)</span>,</span>
<span>    fit_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>epochs <span class="op">=</span> <span class="fl">5</span>, batch_size <span class="op">=</span> <span class="fl">32</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>For <code>learner_type = "caret"</code>, it defaults to a linear
regression with no re sampling (see <a href="https://topepo.github.io/caret/model-training-and-tuning.html" class="external-link uri">https://topepo.github.io/caret/model-training-and-tuning.html</a>
for details about the caret train parameters):</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_model_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>, caret_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, trControl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Please note that the list should contain an element
<code>formula</code> where <code>Y</code> refers to the vector that you
provided as input for <code>Y</code>, and an element named
<code>caret_params</code> containing the parameters of your choice to
pass to <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train</a></code> (see full list of parameters here: <a href="https://topepo.github.io/caret/model-training-and-tuning.html" class="external-link uri">https://topepo.github.io/caret/model-training-and-tuning.html</a>).</p>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="case-of-categorical-target-y">Case of categorical target Y<a class="anchor" aria-label="anchor" href="#case-of-categorical-target-y"></a>
</h4>
<p>When using <code>caret</code>, note that if <code>Y</code> is
categorical and you are using <code>model_type = "s_learner"</code>, you
need to choose a classification method outputting probabilities
i.e. using the key word <code>classProbs = TRUE</code> in
<code>trainControl</code>, see the following as an example with a Random
Forest Classifier:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>, caret_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rf"</span>, trControl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span>, classProbs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Also note that all data inputs needs to be of numeric types, hence
for <code>Y</code> categorical, it should contain numeric values
representing the class of each observation. No need to use the type
<code>factor</code> for <code><a href="../reference/cram_policy.html">cram_policy()</a></code>.</p>
<p>Note on M-learner: If <code>model_type = "m_learner"</code>, keep in
mind that Y is transformed internally. M-learner requires a propensity
model and transformed outcomes:</p>
<ul>
<li>propensity is an argument of cram_policy, if <code>NULL</code>, it
defaults to</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">propensity</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<ul>
<li>outcome_transform is an element of model_params accessed as
follows:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome_transform</span> <span class="op">&lt;-</span> <span class="va">model_params</span><span class="op">$</span><span class="va">m_learner_outcome_transform</span></span></code></pre></div>
<p>If <code>NULL</code>, it defaults to</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>outcome_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, D, prop_score) {Y <span class="sc">*</span> D <span class="sc">/</span> prop_score <span class="sc">-</span> Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> D) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> prop_score)}<span class="st">`</span><span class="at">, where </span><span class="st">`</span>prop_score<span class="st">`</span><span class="at"> is </span><span class="st">`</span><span class="fu">propensity</span>(X)</span></code></pre></div>
<p>Thus, the Y transformed might not be categorical even though Y is
categorical i.e. you might want to use a regression model.</p>
<p>See the following reference for more details about the M-learner:</p>
<p>Jia, Z., Imai, K., &amp; Li, M. L. (2024). <em>The Cram Method for
Efficient Simultaneous Learning and Evaluation</em>, URL: <a href="https://www.hbs.edu/ris/Publication%20Files/2403.07031v1_a83462e0-145b-4675-99d5-9754aa65d786.pdf" class="external-link uri">https://www.hbs.edu/ris/Publication%20Files/2403.07031v1_a83462e0-145b-4675-99d5-9754aa65d786.pdf</a>.</p>
<p>You can override any of these defaults by passing a custom list to
model_params including any parameter name defined in the underlying
package of the model that you chose, namely
<code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">grf::causal_forest()</a></code>, <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">glmnet::cv.glmnet()</a></code>,
<code>keras</code> and <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train()</a></code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Significance level for confidence intervals (default = 95%)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>  </span>
<span></span>
<span><span class="co"># Run the CRAM policy method</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cram_policy.html">cram_policy</a></span><span class="op">(</span></span>
<span>  <span class="va">X</span>, <span class="va">D</span>, <span class="va">Y</span>,</span>
<span>  batch <span class="op">=</span> <span class="va">batch</span>,</span>
<span>  model_type <span class="op">=</span> <span class="va">model_type</span>,</span>
<span>  learner_type <span class="op">=</span> <span class="va">learner_type</span>,</span>
<span>  baseline_policy <span class="op">=</span> <span class="va">baseline_policy</span>,</span>
<span>  parallelize_batch <span class="op">=</span> <span class="va">parallelize_batch</span>,</span>
<span>  model_params <span class="op">=</span> <span class="va">model_params</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; $raw_results</span></span>
<span><span class="co">#&gt;                        Metric   Value</span></span>
<span><span class="co">#&gt; 1              Delta Estimate 0.23208</span></span>
<span><span class="co">#&gt; 2        Delta Standard Error 0.05862</span></span>
<span><span class="co">#&gt; 3              Delta CI Lower 0.11718</span></span>
<span><span class="co">#&gt; 4              Delta CI Upper 0.34697</span></span>
<span><span class="co">#&gt; 5       Policy Value Estimate 0.21751</span></span>
<span><span class="co">#&gt; 6 Policy Value Standard Error 0.05237</span></span>
<span><span class="co">#&gt; 7       Policy Value CI Lower 0.11486</span></span>
<span><span class="co">#&gt; 8       Policy Value CI Upper 0.32016</span></span>
<span><span class="co">#&gt; 9          Proportion Treated 0.60500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $interactive_table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_policy_model</span></span>
<span><span class="co">#&gt; GRF forest object of type causal_forest </span></span>
<span><span class="co">#&gt; Number of trees: 100 </span></span>
<span><span class="co">#&gt; Number of training samples: 1000 </span></span>
<span><span class="co">#&gt; Variable importance: </span></span>
<span><span class="co">#&gt;     1     2     3 </span></span>
<span><span class="co">#&gt; 0.437 0.350 0.213</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="custom-model">Custom Model<a class="anchor" aria-label="anchor" href="#custom-model"></a>
</h3>
<p>To use your own model for policy learning, the trigger is to set
<code>model_type = NULL</code> and to supply two user-defined
functions:</p>
<div class="section level4">
<h4 id="custom_fitx-y-d----">1. <code>custom_fit(X, Y, D, ...)</code><a class="anchor" aria-label="anchor" href="#custom_fitx-y-d----"></a>
</h4>
<p>This function takes the training data: covariates <code>X</code>,
outcomes <code>Y</code>, and binary treatment indicators <code>D</code>,
and returns a fitted model object.<br>
You may also define and use additional parameters (e.g., number of
folds, regularization settings, etc.) within the function body.</p>
<ul>
<li>
<code>X</code>: a matrix or data frame of features</li>
<li>
<code>Y</code>: a numeric outcome vector<br>
</li>
<li>
<code>D</code>: a binary vector indicating treatment assignment (0
or 1)</li>
</ul>
<p><strong>Example</strong>: Custom X-learner with Ridge regression and
5-fold cross-validation</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span></span>
<span><span class="va">custom_fit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">D</span>, <span class="va">n_folds</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">treated_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">D</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">control_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">D</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">X_treated</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">treated_indices</span>, <span class="op">]</span></span>
<span>  <span class="va">Y_treated</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">treated_indices</span><span class="op">]</span></span>
<span>  <span class="va">X_control</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">control_indices</span>, <span class="op">]</span></span>
<span>  <span class="va">Y_control</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">control_indices</span><span class="op">]</span></span>
<span>  <span class="va">model_treated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_treated</span><span class="op">)</span>, <span class="va">Y_treated</span>, alpha <span class="op">=</span> <span class="fl">0</span>, nfolds <span class="op">=</span> <span class="va">n_folds</span><span class="op">)</span></span>
<span>  <span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_control</span><span class="op">)</span>, <span class="va">Y_control</span>, alpha <span class="op">=</span> <span class="fl">0</span>, nfolds <span class="op">=</span> <span class="va">n_folds</span><span class="op">)</span></span>
<span>  <span class="va">tau_control</span> <span class="op">&lt;-</span> <span class="va">Y_treated</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_control</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_treated</span><span class="op">)</span>, s <span class="op">=</span> <span class="st">"lambda.min"</span><span class="op">)</span></span>
<span>  <span class="va">tau_treated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_treated</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_control</span><span class="op">)</span>, s <span class="op">=</span> <span class="st">"lambda.min"</span><span class="op">)</span> <span class="op">-</span> <span class="va">Y_control</span></span>
<span>  <span class="va">X_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">X_treated</span>, <span class="va">X_control</span><span class="op">)</span></span>
<span>  <span class="va">tau_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tau_control</span>, <span class="va">tau_treated</span><span class="op">)</span></span>
<span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tau_control</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tau_treated</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_combined</span><span class="op">)</span>, <span class="va">tau_combined</span>, alpha <span class="op">=</span> <span class="fl">0</span>, weights <span class="op">=</span> <span class="va">weights</span>, nfolds <span class="op">=</span> <span class="va">n_folds</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">final_model</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="custom_predictmodel-x_new-d_new">2. <code>custom_predict(model, X_new, D_new)</code><a class="anchor" aria-label="anchor" href="#custom_predictmodel-x_new-d_new"></a>
</h4>
<p>This function uses the fitted model to generate a <strong>binary
treatment decision</strong> for each individual in
<code>X_new</code>.</p>
<p>It should return a vector of 0s and 1s, indicating whether to assign
treatment (<code>1</code>) or not (<code>0</code>).<br>
You may also incorporate a custom threshold or post-processing logic
within the function.</p>
<p><strong>Example</strong>: Apply the decision rule — treat if the
estimated CATE is greater than 0</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_predict</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">X_new</span>, <span class="va">D_new</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X_new</span><span class="op">)</span>, s <span class="op">=</span> <span class="st">"lambda.min"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Apply decision rule: treat if CATE &gt; 0</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">cate</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="use-cram_policy-with-custom_fit-and-custom_predict">3. Use <code>cram_policy()</code> with <code>custom_fit()</code> and
<code>custom_predict()</code><a class="anchor" aria-label="anchor" href="#use-cram_policy-with-custom_fit-and-custom_predict"></a>
</h4>
<p>Once both <code>custom_fit()</code> and <code>custom_predict()</code>
are defined, you can integrate them into the Cram framework by passing
them to <code><a href="../reference/cram_policy.html">cram_policy()</a></code> as shown below (do not forget to set
<code>model_type = NULL</code>):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">experiment_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cram_policy.html">cram_policy</a></span><span class="op">(</span></span>
<span>  <span class="va">X</span>, <span class="va">D</span>, <span class="va">Y</span>,</span>
<span>  batch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  model_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_fit <span class="op">=</span> <span class="va">custom_fit</span>,</span>
<span>  custom_predict <span class="op">=</span> <span class="va">custom_predict</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">experiment_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; $raw_results</span></span>
<span><span class="co">#&gt;                        Metric   Value</span></span>
<span><span class="co">#&gt; 1              Delta Estimate 0.22542</span></span>
<span><span class="co">#&gt; 2        Delta Standard Error 0.06004</span></span>
<span><span class="co">#&gt; 3              Delta CI Lower 0.10774</span></span>
<span><span class="co">#&gt; 4              Delta CI Upper 0.34310</span></span>
<span><span class="co">#&gt; 5       Policy Value Estimate 0.21085</span></span>
<span><span class="co">#&gt; 6 Policy Value Standard Error 0.04280</span></span>
<span><span class="co">#&gt; 7       Policy Value CI Lower 0.12696</span></span>
<span><span class="co">#&gt; 8       Policy Value CI Upper 0.29475</span></span>
<span><span class="co">#&gt; 9          Proportion Treated 0.54500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $interactive_table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $final_policy_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  cv.glmnet(x = as.matrix(X_combined), y = tau_combined, weights = weights,      nfolds = n_folds, alpha = 0) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Measure: Mean-Squared Error </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Lambda Index Measure      SE Nonzero</span></span>
<span><span class="co">#&gt; min 0.0395   100  0.9219 0.02942       3</span></span>
<span><span class="co">#&gt; 1se 0.5868    71  0.9505 0.03367       3</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>Jia, Z., Imai, K., &amp; Li, M. L. (2024). <em>The Cram Method for
Efficient Simultaneous Learning and Evaluation</em>, URL: <a href="https://www.hbs.edu/ris/Publication%20Files/2403.07031v1_a83462e0-145b-4675-99d5-9754aa65d786.pdf" class="external-link uri">https://www.hbs.edu/ris/Publication%20Files/2403.07031v1_a83462e0-145b-4675-99d5-9754aa65d786.pdf</a>.<br>
</li>
<li>Künzel, S. R., Sekhon, J. S., Bickel, P. J., &amp; Yu, B. (2019).
Metalearners for estimating heterogeneous treatment effects using
machine learning. Proceedings of the National Academy of Sciences of the
United States of America, 116(10), 4156–4165. <a href="https://doi.org/10.1073/pnas.1804597116" class="external-link uri">https://doi.org/10.1073/pnas.1804597116</a>
</li>
<li>Wager, S., &amp; Athey, S. (2018). Estimation and inference of
heterogeneous treatment effects using random forests. Journal of the
American Statistical Association, 113(523), 1228-1242.</li>
<li>Athey, S., &amp; Imbens, G. (2016). Recursive partitioning for
heterogeneous causal effects. Proceedings of the National Academy of
Sciences, 113(27), 7353-7360.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yanis Vandecasteele, Michael Lingzhi Li, Kosuke Imai, Zeyang Jia, Longlin Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
